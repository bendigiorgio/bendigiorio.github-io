"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@tolgee/core");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function t(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}})),r.default=e,Object.freeze(r)}var u=n(e),o=function(){return o=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var u in r=arguments[n])Object.prototype.hasOwnProperty.call(r,u)&&(e[u]=r[u]);return e},o.apply(this,arguments)};function a(e,r){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var t,u,o=n.call(e),a=[];try{for(;(void 0===r||r-- >0)&&!(t=o.next()).done;)a.push(t.value)}catch(e){u={error:e}}finally{try{t&&!t.done&&(n=o.return)&&n.call(o)}finally{if(u)throw u.error}}return a}var c=u.default.createContext(null),i=function(){var r=e.useContext(c);if(null===r)throw new Error("Tolgee context is null. Is this code executed inside TolgeeProvider component?");return r},f=function(e){if(e){var r={};return Object.entries(e||{}).forEach((function(e){var n=a(e,2),t=n[0],c=n[1];if("function"==typeof c)r[t]=function(e){return c(l(e))};else if(u.default.isValidElement(c)){var i=c;r[t]=function(e){return o(o({},i),{props:o(o({},i.props),{children:l(e)})})}}else r[t]=c})),r}},l=function(e){return Array.isArray(e)?u.default.Children.toArray(e):e},s=function(){var r=i().tolgee,n=e.useRef(!1),t=a(e.useState(0),2),u=t[0],o=t[1];e.useEffect((function(){return n.current=!0,function(){n.current=!1}}),[]);var c=e.useCallback((function(){n.current&&o((function(e){return e+1}))}),[o,n]),s=e.useRef([]),d=function(e){s.current=e?s.current.filter((function(r){return r!==e})):[]};e.useEffect((function(){var e=r.onTranslationChange.subscribe((function(e){var r=e.key;s.current.includes(r)&&(d(r),c())}));return function(){return e.unsubscribe()}}),[r]),e.useEffect((function(){var e=r.onLangChange.subscribe((function(){s.current.length&&(d(),c())}));return function(){return e.unsubscribe()}}),[r]);var g=e.useCallback((function(e,n,t,u){var o=!s.current.includes(e),a=r.instant({key:e,params:f(n),noWrap:t,defaultValue:u});return o&&(s.current.push(e),r.translate({key:e,params:f(n),noWrap:t,defaultValue:u}).then((function(e){e!==a&&c()}))),a}),[r,s]),p=e.useCallback((function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var t=void 0,u=void 0,o=void 0,a="object"==typeof e?e.key:e;return"object"==typeof e?(t=e.parameters,u=e.noWrap,o=e.defaultValue):r.forEach((function(e){switch(typeof e){case"object":t=e;break;case"boolean":u=e;break;case"string":o=e}})),l(g(a,t,u,o))}),[g,u]);return p};exports.T=function(e){var r=e.keyName||e.children;r||console.error("T component: keyName not defined");var n=e.keyName?e.children:void 0,t=s()({key:r,parameters:e.parameters,defaultValue:n,noWrap:e.noWrap});return u.default.createElement(u.default.Fragment,null,t)},exports.TolgeeProvider=function(n){var i=o({},n);delete i.children,delete i.loadingFallback;var f=a(e.useState(r.Tolgee.use(r.IcuFormatter).init(o({wrapperMode:"invisible",ui:"development"!==process.env.NODE_ENV?void 0:"undefined"!=typeof require?require("@tolgee/ui"):Promise.resolve().then((function(){return t(require("@tolgee/ui"))}))},i))),1)[0],l=a(e.useState(f.initialLoading),2),s=l[0],d=l[1];return e.useEffect((function(){void 0!==i.forceLanguage&&(f.properties.config.forceLanguage=i.forceLanguage,f.lang=i.forceLanguage)}),[i.forceLanguage]),e.useEffect((function(){return f.run().then((function(){return d(!1)})),function(){f.stop()}}),[]),u.default.createElement(c.Provider,{value:o(o({},n),{tolgee:f})},s?n.loadingFallback:n.children)},exports.TolgeeProviderContext=c,exports.useCurrentLanguage=function(){var r=i(),n=a(e.useState(r.tolgee.lang),2),t=n[0],u=n[1];return e.useEffect((function(){var e=r.tolgee.onLangChange.subscribe((function(e){u(e)}));return function(){e.unsubscribe()}}),[]),function(){return t}},exports.useSetLanguage=function(){var e=i();return function(r){return e.tolgee.changeLanguage(r)}},exports.useTranslate=s;
//# sourceMappingURL=tolgee-react.cjs.min.js.map
