!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("@tolgee/core")):"function"==typeof define&&define.amd?define(["exports","react","@tolgee/core"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self)["@tolgee/react"]={},e.React,e["@tolgee/core"])}(this,(function(e,n,r){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=t(n),o=function(){return o=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var u in n=arguments[r])Object.prototype.hasOwnProperty.call(n,u)&&(e[u]=n[u]);return e},o.apply(this,arguments)};function a(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var t,u,o=r.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(t=o.next()).done;)a.push(t.value)}catch(e){u={error:e}}finally{try{t&&!t.done&&(r=o.return)&&r.call(o)}finally{if(u)throw u.error}}return a}var i=u.default.createContext(null),c=function(){var e=n.useContext(i);if(null===e)throw new Error("Tolgee context is null. Is this code executed inside TolgeeProvider component?");return e},f=function(e){if(e){var n={};return Object.entries(e||{}).forEach((function(e){var r=a(e,2),t=r[0],i=r[1];if("function"==typeof i)n[t]=function(e){return i(l(e))};else if(u.default.isValidElement(i)){var c=i;n[t]=function(e){return o(o({},c),{props:o(o({},c.props),{children:l(e)})})}}else n[t]=i})),n}},l=function(e){return Array.isArray(e)?u.default.Children.toArray(e):e},s=function(){var e=c().tolgee,r=n.useRef(!1),t=a(n.useState(0),2),u=t[0],o=t[1];n.useEffect((function(){return r.current=!0,function(){r.current=!1}}),[]);var i=n.useCallback((function(){r.current&&o((function(e){return e+1}))}),[o,r]),s=n.useRef([]),d=function(e){s.current=e?s.current.filter((function(n){return n!==e})):[]};n.useEffect((function(){var n=e.onTranslationChange.subscribe((function(e){var n=e.key;s.current.includes(n)&&(d(n),i())}));return function(){return n.unsubscribe()}}),[e]),n.useEffect((function(){var n=e.onLangChange.subscribe((function(){s.current.length&&(d(),i())}));return function(){return n.unsubscribe()}}),[e]);var g=n.useCallback((function(n,r,t,u){var o=!s.current.includes(n),a=e.instant({key:n,params:f(r),noWrap:t,defaultValue:u});return o&&(s.current.push(n),e.translate({key:n,params:f(r),noWrap:t,defaultValue:u}).then((function(e){e!==a&&i()}))),a}),[e,s]),p=n.useCallback((function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var t=void 0,u=void 0,o=void 0,a="object"==typeof e?e.key:e;return"object"==typeof e?(t=e.parameters,u=e.noWrap,o=e.defaultValue):n.forEach((function(e){switch(typeof e){case"object":t=e;break;case"boolean":u=e;break;case"string":o=e}})),l(g(a,t,u,o))}),[g,u]);return p};e.T=function(e){var n=e.keyName||e.children;n||console.error("T component: keyName not defined");var r=e.keyName?e.children:void 0,t=s()({key:n,parameters:e.parameters,defaultValue:r,noWrap:e.noWrap});return u.default.createElement(u.default.Fragment,null,t)},e.TolgeeProvider=function(e){var t=o({},e);delete t.children,delete t.loadingFallback;var c=a(n.useState(r.Tolgee.use(r.IcuFormatter).init(o({wrapperMode:"invisible",ui:"development"!==process.env.NODE_ENV?void 0:"undefined"!=typeof require?require("@tolgee/ui"):import("@tolgee/ui")},t))),1)[0],f=a(n.useState(c.initialLoading),2),l=f[0],s=f[1];return n.useEffect((function(){void 0!==t.forceLanguage&&(c.properties.config.forceLanguage=t.forceLanguage,c.lang=t.forceLanguage)}),[t.forceLanguage]),n.useEffect((function(){return c.run().then((function(){return s(!1)})),function(){c.stop()}}),[]),u.default.createElement(i.Provider,{value:o(o({},e),{tolgee:c})},l?e.loadingFallback:e.children)},e.TolgeeProviderContext=i,e.useCurrentLanguage=function(){var e=c(),r=a(n.useState(e.tolgee.lang),2),t=r[0],u=r[1];return n.useEffect((function(){var n=e.tolgee.onLangChange.subscribe((function(e){u(e)}));return function(){n.unsubscribe()}}),[]),function(){return t}},e.useSetLanguage=function(){var e=c();return function(n){return e.tolgee.changeLanguage(n)}},e.useTranslate=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tolgee-react.umd.min.js.map
